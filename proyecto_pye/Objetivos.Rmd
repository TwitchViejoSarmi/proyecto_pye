---
title: "Avance 1 del Proyecto Probabiliad y Estadística"
author: "Alejandro Sarmiento Rivera y Juan Esteban Becerra Gutiérrez"
date: "2024-05-20"
output:
  html_document: default
  pdf_document: default
---

## Problema de Estudio

Determinar los factores asociados con el peso al nacer de los recién nacidos en el Municipio de La Dorada durante los años 2021 y 2022.

## Objetivo General

Analizar la influencia de diversos factores médicos y del entorno en el peso al nacer de los recién nacidos en el Municipio de La Dorada.

## Objetivos Específicos

-   Analizar la distribución del peso al nacer por categorías de variables de localización, en este caso, por Área de Residencia (CABECERA MUNICIPAL/CENTRO POBLADO/RURAL DISPERSO).
-   Comparar las proporciones de sitios de nacimiento del infante (DOMICILIO/INSTITUCIÓN DE SALUD) por centros poblados para que tenga sentido con el objetivo anterior.
-   Estudiar si existe una relación lineal entre el peso al nacer y la talla al nacer del infante.

## Variables de análisis:

1.  Se va a analizar el peso al nacer de los bebés por Área de Residencia. Esto permitirá estudiar la influencia de la localización con el peso.
2.  Se va a categorizar el tipo de parto del bebé (CESAREA/ESPONTÁNEO/INSTRUMENTADO) por las mismas Áreas de Residencia. Esto permite evaluar la posibilidad de si el tipo de parto pueda afectar el peso final del infante. También, se permitirá ver cuáles áreas se registra cada tipo de parto con el objetivo de de ver en que localización se aplica dicho tipo de parto.
3.  Se quiere estudiar la existencia de una relación lineal entre el peso y la talla del bebé. Esto permitirá aclarar si hay alguna relación entre el peso y la talla y/o viceversa.

## Carga de Datos

```{r}
library(readxl)
library(dplyr)
Base_Datos <- read.csv("Base de Datos/Datos.csv")
```

## Limpieza de Datos

```{r}
Base_Datos$PESO..Gramos. <- gsub(",", ".", Base_Datos$PESO..Gramos.)
Base_Datos$PESO..Gramos. <- as.numeric(Base_Datos$PESO..Gramos.)
Base_Datos$TALLA..Centímetros. <- gsub(",", ".", Base_Datos$TALLA..Centímetros.)
Base_Datos$TALLA..Centímetros. <- as.numeric(Base_Datos$TALLA..Centímetros.)
Base_Datos <- subset(Base_Datos, PESO..Gramos. < 575) # Se hace limpieza de datos.
```

Primero, se decidió trabajar el peso en kilogramos en vez de gramos. Esto debido a que, en la Base de Datos, el formato usado para escribir los pesos estaba en cadena de texto y no como númerico. Para que R hiciera una conversión más sencilla, era necesario pasar las "," a los "." y de ahí convertirlos a númericos. Para el caso de la talla sucedió algo parecido, pero como ya se encontraba es centímetros no hubo mucha complicación con la conversión. También, se tuvieron que eliminar los pesos que fueran superiores a 575 ya que, originalmente, los datos eran valores muy pequeños. Cuando se realizó el cambio de g a kg, no se hizo correctamente para estos datos que eran incorrectos, por lo que se cambió a eliminar los que fueran superiores a 575.

### OBJETIVO 1: TABLA RESUMEN

```{r}
tabla <- Base_Datos %>%
  group_by(AREA.RESIDENCIA) %>%
  summarise(media = round(mean(PESO..Gramos., na.rm = TRUE), digits = 2),
  mediana = median(PESO..Gramos., na.rm = TRUE),
  sd = round(sd(PESO..Gramos., na.rm = TRUE), digits = 2),
  q1 = quantile(PESO..Gramos., probs = 0.25, na.rm = TRUE),
  q3 = quantile(PESO..Gramos., probs = 0.75, na.rm = TRUE),
  RIC = IQR(PESO..Gramos., na.rm = TRUE)
  )
print(tabla)
```

*Tabla 1: Resumen de datos extraídos para comparar pesos al nacer por área de residencia.*

**Análisis Estadístico:**

-   Para el caso de la media o promedio, se puede observar que hay unas diferencias muy pequeñas entre cada área de residencia de la madre del pequeño, siendo las que quedan más alejadas de la cabecera municipal en las que los infantes nacen con un peso promedio menor, es decir, los centros poblados y las zonas rurales dispersas.

-   Para el caso de la mediana, se puede apreciar que tiene un valor aproximado casi idéntico al de la media para el caso de la cabecera municipal, por lo que se puede interpretar que los pesos de los pequeños cuyas madres viven allí, son relativamente simétricos. Por otra parte, para las otras áreas de residencia, varía un poco la mediana con la media, por lo que no son pesos tan simétricos como en la cabecera municipal.

-   Para el caso de la desviación estándar, tanto la cabecera municipal como el centro poblado tienen la misma dispersión de valores de peso, mientras que para las zonas rurales, su desviación es menor. Esto puede interpretarse como que los pesos de los bebés que tienen madres que viven en zonas rurales son más cercanos al promedio que para los otros casos.

-   Tanto para los cuartiles evaluados como para el RIC se tiene lo siguiente. Aproximadamente, el 25% de los bebés tiene un peso mayor cuando su madre vive en un Centro Poblado a comparación de los otros casos, mientras que aproximadamente el 75% de los bebés tienen un peso mayor cuando su madre vive en la Cabecera Municipal. Para el RIC, se puede observar que la Cabecera Municipal es la que tiene mayor rango entre las otras opciones.

### OBJETIVO 1: GRÁFICO DE CAJAS COMPARATIVO PESO VS ÁREA DE RESIDENCIA

```{r}
# Gráfico 1.
PESO <- Base_Datos$PESO..Gramos.

par(mar = c(5, 3.9, 0.5, 0.5) + 0.1)
boxplot(PESO ~ Base_Datos$AREA.RESIDENCIA,
        xlab = "ÁREA DE RESIDENCIA",
        ylab = "PESO (KILOGRAMOS)",
        names = c("CABEZERA MUNICIPAL", "CENTRO POBLADO", "RURAL DISPERSO"),
        cex.main = 0.8
        )
```

*Figura 1: Gráfico de Cajas para comparar Peso con Área de Residencia de la madre.*

**Apectos relevantes**

-   En el gráfico, se puede apreciar para la categoría de **Cabezera municipal** y **Centro poblado** contienen una mayor dispersión de los datos con respecto a **Rural disperso**, al haber mayor presencia de datos atípicos. Además, en la misma categoría, hay un grupo considerable de bebés que nacen con peso menor al promedio (Ver Figura 1).
-   Para las 3 categorías de **Área de residencia** los bebés nacidos en cada categoría poseen un peso al nacer mayor a aproximadamente 3 kilogramos y menor a aproximadamente 3.5 kilogramos (Ver Figura 1).
-   Los 3 gráficos de cajas muestran que para todas las categorías de **Área de residencia**, el valor de sus medianas están dentro del mismo rango de 3 kilogramos a 3.5 kilogramos. Sin embargo, la mediana de la categoría **rural disperso** es ligeramente menor a las otras 2 categorías (Ver Figura n).
-   Para la categoría de de **centro poblado** se puede apreciar una poca dispersión de los registros de los pesos de los bebés recién nacidos dentro de los limites de los mismos datos.

### OBJETIVO 1: POLÍGONO DE FRECUENCIAS COMPARATIVO DE PESOS AL NACER POR ÁREA DE RESIDENCIA

```{r}
# Gráfico 2.
PESO_C <- subset(Base_Datos, AREA.RESIDENCIA == "CABECERA MUNICIPAL")$PESO..Gramos.

His_C <- hist(PESO_C, plot = FALSE)

PESO_CP <- subset(Base_Datos, AREA.RESIDENCIA == "CENTRO POBLADO (INSPECCIÓN, CORREGIMIENTO O CASERÍO)")$PESO..Gramos.

His_CP <- hist(PESO_CP, plot = FALSE)

PESO_R <- subset(Base_Datos, AREA.RESIDENCIA == "RURAL DISPERSO")$PESO..Gramos.

His_R <- hist(PESO_R, plot = FALSE)

plot(c(min(PESO), His_C$mids, max(PESO)), c(0, His_C$counts, 0), type = "b", col = "red", xlab = "PESO (g)", ylab = "FRECUENCIA")

lines(c(min(PESO), His_CP$mids, max(PESO)), c(0, His_CP$counts, 0), type = "b", col = "blue")

lines(c(min(PESO), His_R$mids, max(PESO)), c(0, His_R$counts, 0), type = "b", col = "green")

legend("topleft", legend = c("CABECERA MUNICIPAL", "CENTRO POBLADO", "RURAL DISPERSO"), 
       fill = c("red", "blue", "green"))
```

*Figura 2: Polígono de Frecuencias para comparar tendencia de pesos al nacer por área de residencia.*

**Apectos relevantes**

-   La gráfica muestra que para todas las categorías de **Área de residencia**, el valor de sus medianas están dentro del mismo rango de 3 kilogramos a 3 kilogramos debido a que el comportamiento de las 3 categorías se comporta de manera simetrica. Además, con lo anterior, se puede decir que, debido a que todos poseen aproximadamente la misma media, el valor medio o media sea similar para todas las categorias.

-   Se observa una gran diferencia en la distribución de la talla de los pesos por **Área de residencia.** Se observa que la categoría **Cabezera municipal** posee una mayor frecuencia para los pesos mayores a 3 kilogramos y menores a 4 kilogramos.

-   En el gráfico se puede apreciar que tanto **Centro poblado** y **Rural disperso** poseen una distribución muy similar por lo que se puede decir que sus media

-   Se puede denotar gracias a la gráfica que para las 3 categorias, tienen un ligero cesgo hacia la izquierda, es decir los datos pesos al nacer se concentran más en el rango de 2 kilogramos a 4 kilogramos

### OBJETIVO 1: OJIVA COMPARATIVA DE PESOS AL NACER POR ÁREA DE RESIDENCIA

```{r}
# Gráfico 3.
plot(c(0, His_C$mids),
     c(0, cumsum(His_C$counts)/sum(His_C$counts)),
     type = "b",
     col = "red",
     xlab = "PESO (KILOGRAMOS)",
     ylab = "FRECUENCIA RELATIVA ACUMULADA")

lines(c(0, His_CP$mids),
      c(0, cumsum(His_CP$counts)/sum(His_CP$counts)),
      type = "b",
      col = "blue")

lines(c(0, His_R$mids),
      c(0, cumsum(His_R$counts)/sum(His_R$counts)),
      type = "b",
      col = "green")
legend("topleft", legend = c("CABECERA MUNICIPAL", "CENTRO POBLADO", "RURAL DISPERSO"), 
       fill = c("red", "blue", "green"))
```

*Figura 3: Ojiva que permite comparar las frecuencias relativas acumuladas por cada categoría.*

**Apectos relevantes**

-   Las curvas de frecuencia relativa acumulada para las tres áreas de residencia (cabecera municipal, centro poblado, y rural disperso) son muy similares, especialmente en la región de 2 a 4 kilogramos. Esto sugiere que no hay grandes diferencias en la distribución del peso al nacer entre estas áreas.

-   Todas las curvas muestran un aumento pronunciado en la frecuencia acumulada en el rango de aproximadamente de 2.5 a 3.5 kilogramos. Esto indica que la mayoría de los nacimientos ocurren en este rango de peso, lo cual es consistente con el peso promedio al nacer esperado.

-   La distribución del peso al nacer es más desigual en la **Cabezera municipal** que en el **Centro poblado** y en el **Área rural disperso**.

-   Las curvas para las tres áreas alcanzan el 100% de la frecuencia acumulada muy cerca de los 4 kilogramos, indicando que este es el peso máximo observado en la muestra para todas las áreas de residencia. Esto también sugiere que los pesos al nacer mayores de 4 kilogramos son raros o inexistentes en esta muestra.

### Análisis del objetivo 1

De acuerdo con estos aspectos podemos decir que, en primer lugar, la gran mayoría de los bebés nacidos en el municipio de la Dorada en el año 2021 y 2022 nacieron en las **cabeceras municipales,** seguido de las zonas rurales dispersas y por último los **centros poblados.** Al ver los resultados de los datos, se puede apreciar que los pesos de los bebés nacidos en el municipio de la dorada no se ven afectados por el área de  ya que para todas las zonas los pesos de los infantes siempre tienden al mismo rango de 3kg a 4kg. Sin embargo, cabe destacar que la gran parte de los nacimientos en las cabeceras municipales se debe a que estas zonas contienen una gran cantidad y mejores servicios de salud comparados con otras zonas, por lo que, si se presenta un caso atípico de peso por razones de salud de la madre, los servicios estarán disponibles para atender la situación.

### OBJETIVO 2: TABLA DE FRECUENCIAS DEL TIPO DE PARTO CATEGORIZADO POR EL ÁREA DE RESIDENCIA

```{r}
tabla <- table(Base_Datos$TIPO.PARTO, Base_Datos$AREA.RESIDENCIA)
colnames(tabla) <- c("CABECERA MUNICIPAL", "CENTRO POBLADO", "RURAL DISPERSO")
print(tabla)
```

*Tabla 2: Tabla de frecuencias para el tipo de parto categorizado por área de residencia de la madre.*

*Nota: La única estadística descriptiva que se ha podido encontrar en este caso y ha tenido relevancia para el objetivo ha sido la moda (interpretada en la tabla de frecuencias)*

**Análisis Estadístico:**

En este caso, se puede observar que, para todas las áreas de residencia, la mayor cantidad de partos se han realizado de manera espontánea, es decir, de manera natural. Por otra parte, se puede observar que se han presenciado, en general, muy pocos casos en los que se ha requerido de instrumentación para poder ayudar al bebé a salir del cuerpo de la madre. Sin embargo, han habido más casos de este estilo para las madres que viven en la Cabecera Municipal. Esto muestra que puede que no haya un verdadero impacto en el peso del recién nacido cuando se interviene en el parto de manera distinta, ya que las proporciones de los datos son bastante parecidas, aunque con mayor medida en la Cabecera Municipal.

### OBJETIVO 2: GRÁFICO DE BARRAS COMPARATIVO DEL TIPO DE PARTO CATEGORIZADO POR EL ÁREA DE RESIDENCIA

```{r}
par(mar = c(5, 3.9, 0.5, 0.5) + 0.1)

barplot(tabla, #prop.table(tabla),
        beside = TRUE,
        col = c("blue","red", 'green'),
        xlab = "Area de residencia",
        ylab = "Cantidad de partos",
        names = c("CABEZERA MUNICIPAL", "CENTRO POBLADO", "RURAL DISPERSO"))
legend("topright", legend = c("Cesárea", "Espontáneo", "Instrumentado"), 
       fill = c("blue","red", 'green'))
```

*Figura 4: Gráfico de Barras que permite comparar las frecuencias de cada tipo de parto por cada categoría.*

**Apectos relevantes**

-   En los **Centros poblados** , los partos espontáneos son igualmente comunes que los partos por cesarea aunque estos últimos se presentan en una ligera menor cantidad.

-   La **cabecera municipal** tiene una mayor cantidad total de partos en comparación con las **áreas rurales dispersas** y los **centros poblados**.

-   Tanto en la **cabecera municipal** como en las **áreas rurales dispersas** y los **centros poblados** los partos espontáneos son los más frecuentes, seguidos por las cesáreas.

-   Para las **cabeceras municipales** se registran una minima cantidad de partos instrumentados no superando aproximadamente los 50 partos mientras que en los **centros poblados** o **áreas rurales dispersas** es dato es casi nulo.

### Análisis del objetivo 2

Con base en los aspectos relevantes, se puede apreciar que al igual que en el objetivo 1 la gran mayoría de los bebés nacidos en el municipio de la Dorada en el año 2021 y 2022 nacieron en las **cabeceras municipales,** seguido de las zonas rurales dispersas y por último los **centros poblados.** Además, los datos afirman que la gran parte de los nacimientos para todos los tipos de parto, se dieron mediante un **parto espontáneo** seguido de parto por **cesárea y** por último se presentan casos mínimos o nulos de partos **instrumentados.** Esto es posible ya que en las cabeceras municipales se debe a que estas zonas contienen una gran cantidad y mejores servicios de salud comparados con otras zonas. Complementando con el objetivo anterior (objetivo 1) se puede llegar a la conclusión de que el tipo de parto no afecta en una gran parte al peso del bebé.

### OBJETIVO 3: TABLA RESUMEN

```{r}
tabla <- Base_Datos %>%
  summarise(
  sd_peso = round(sd(PESO..Gramos., na.rm = TRUE), digits = 2),
  sd_talla = round(sd(TALLA..Centímetros., na.rm = TRUE), digits = 2),
  
  correlacion = cor(PESO..Gramos., TALLA..Centímetros.)
  )
print(tabla)
```

**Análisis Estadístico:**

Algo importante que se ha podido evidenciar, es que a diferencia de la desviación estándar para el peso, la de la talla de los bebés es muy superior, indicando que hay una mayor dispersión entre los datos tomados para las tallas en comparación con el peso. No obstante, se puede apreciar que ambas variables tienen correlación, aunque no es del todo fuerte, por lo que se puede decir que tienen una cierta relación lineal entre sus valores.

### OBJETIVO 3: GRÁFICO DE DISPERSIÓN DE PESO AL NACER DEL BEBÉ VS LA TALLA AL NACER DEL BEBÉ

```{r}
TALLA <- Base_Datos$TALLA..Centímetros.
plot(PESO, TALLA,
     xlab = 'PESO (KILOGRAMOS)',
     ylab = 'TALLA (CENTIMETROS)')
```

*Figura 5: Gráfico de Dispersión que permite observar la relación entre la talla y el peso del recién nacido.*

**Aspectos relevantes**

-   El gráfico muestra una tendencia general positiva, lo que indica que a medida que aumenta el peso al nacer del bebé, también tiende a aumentar su talla. Este tipo de relación sugiere que los bebés más pesados tienden a ser más largos.

-   La mayoría de los datos se agrupan entre los pesos de 2.5 a 4 kilogramos y las tallas de 45 a 55 centímetros. Esto sugiere que la mayoría de los bebés en la muestra nacen con estos pesos y tallas.

-   Hay algunos puntos que se encuentran alejados del grupo principal de datos. Por ejemplo, hay bebés con pesos por debajo de 1.5 kg o por encima de 4.0 kg, y tallas por debajo de 40 cm o por encima de 55 cm. Estos outliers pueden indicar casos especiales o extremos que podrían ser relevantes para estudios adicionales.

-   Aunque hay una tendencia positiva general, también hay una ligera pero considerable dispersión en los datos. Por ejemplo, para un peso dado, hay una variabilidad en la talla y viceversa. Esto indica que, aunque el peso y la talla están relacionados, otros factores también pueden influir en estas medidas al nacer.

### Análisis del objetivo 3

Respecto a los aspectos anteriores, la gran mayoría de los datos muestran que, los bebés que nacen con una talla en el rango de 45 a 55 centímetros tienen un peso al nacer en el rango de 2.5 a 4 kilogramos. Además, de acuerdo con la gráfica anterior (Ver figura 5), se puede ver que los datos se comportan de manera proporcional unos a otros, es decir, que a medida que aumenta el peso de nacimiento del bebé, aumenta la talla del nacimiento del bebé.
